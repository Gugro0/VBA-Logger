Version =20
VersionRequired =20
Checksum =-79033665
Begin Form
    AllowFilters = NotDefault
    AutoResize = NotDefault
    PopUp = NotDefault
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularCharSet =204
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =9360
    DatasheetFontHeight =11
    ItemSuffix =64
    Left =3225
    Top =2490
    Right =21345
    Bottom =12465
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0x8f6b6adb20fbe340
    End
    GUID = Begin
        0x233c5a2c7a7a4a42a29492828f083bbd
    End
    NameMap = Begin
        0x0acc0e5500000000000000000000000000000000000000000c00000004000000 ,
        0x0000000000000000000000000000
    End
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00f40243ef8005010009009a0b3408640001000800f00001000100 ,
        0x9000020001004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff0000000000000000000000000000000044494e55 ,
        0x2200b800f402000076c9bcad0000000000000000000000000000000000000000 ,
        0x0000000000000000060000000100000000000000000001000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000010000000000000000000000b8000000534d544a ,
        0x000000001000a80054006f006200690074002000460061007800570061007200 ,
        0x65000000496e70757442696e004155544f00524553444c4c00556e6972657344 ,
        0x4c4c004f7269656e746174696f6e00504f525452414954005265736f6c757469 ,
        0x6f6e004f7074696f6e3100506170657253697a65004f7074696f6e310048616c ,
        0x66746f6e650048545f50415453495a455f535550455243454c4c5f4d00000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x0800160024000100000000000000000000000000000000000000000000000000 ,
        0x00000000466178576172652053657276696365204c6179657200
    End
    OnTimer ="[Event Procedure]"
    OnResize ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =255
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            Width =850
            Height =850
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =11
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            Width =1701
            Height =1701
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin ComboBox
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            AllowValueListEdits =1
            InheritValueList =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            SpecialEffect =2
            Width =4536
            Height =2835
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =11
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin FormHeader
            Height =3004
            BackColor =-2147483606
            Name ="Formularkopf"
            GUID = Begin
                0xeaf9a2f114e4b2449141bc8c75946ca7
            End
            Begin
                Begin Label
                    OverlapFlags =85
                    Left =285
                    Top =2154
                    Width =900
                    Height =285
                    Name ="Bezeichnungsfeld12"
                    Caption ="Number:"
                    GUID = Begin
                        0xab05c3494b62b3499ec2e03183305493
                    End
                    LayoutCachedLeft =285
                    LayoutCachedTop =2154
                    LayoutCachedWidth =1185
                    LayoutCachedHeight =2439
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1415
                    Top =2157
                    Height =315
                    TabIndex =9
                    GUID = Begin
                        0xc043b3c0d655f645820444379fdb62f3
                    End
                    Name ="ctlNumberComparer"
                    RowSourceType ="Value List"
                    RowSource ="\"=\";\"<\";\">\";\"Between\";\"Not Between\""
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =1415
                    LayoutCachedTop =2157
                    LayoutCachedWidth =3116
                    LayoutCachedHeight =2472
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3344
                    Top =2157
                    Height =315
                    TabIndex =10
                    Name ="ctlNumber1"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0xa6e6907317619945add57ae427108bf1
                    End

                    LayoutCachedLeft =3344
                    LayoutCachedTop =2157
                    LayoutCachedWidth =5045
                    LayoutCachedHeight =2472
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =5385
                    Top =2157
                    Height =315
                    TabIndex =11
                    Name ="ctlNumber2"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0x2f35897c162c6e4fa3b696f614e7d72f
                    End

                    LayoutCachedLeft =5385
                    LayoutCachedTop =2157
                    LayoutCachedWidth =7086
                    LayoutCachedHeight =2472
                End
                Begin Label
                    OverlapFlags =85
                    Left =283
                    Top =2613
                    Width =540
                    Height =285
                    Name ="Bezeichnungsfeld20"
                    Caption ="Text:"
                    GUID = Begin
                        0xbd0faba2c2bf9644b31e3211649ef320
                    End
                    LayoutCachedLeft =283
                    LayoutCachedTop =2613
                    LayoutCachedWidth =823
                    LayoutCachedHeight =2898
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1415
                    Top =2610
                    Height =315
                    TabIndex =13
                    GUID = Begin
                        0x5977534fc3e6b74092cc5a36be5d977b
                    End
                    Name ="ctlTextComparer"
                    RowSourceType ="Value List"
                    RowSource ="\"=\";\"Begins with\";\"Contains\";\"<>\";\"Does not contain\";\"Matches\""
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =1415
                    LayoutCachedTop =2610
                    LayoutCachedWidth =3116
                    LayoutCachedHeight =2925
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3342
                    Top =2610
                    Height =315
                    TabIndex =14
                    Name ="ctlText"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0xa6ba18bd4c748c4eaa3f1bf7a8b4bd5f
                    End

                    LayoutCachedLeft =3342
                    LayoutCachedTop =2610
                    LayoutCachedWidth =5043
                    LayoutCachedHeight =2925
                End
                Begin Label
                    OverlapFlags =85
                    Left =285
                    Top =120
                    Width =960
                    Height =315
                    Name ="Bezeichnungsfeld42"
                    Caption ="Category:"
                    GUID = Begin
                        0x716041a53f58c341bf81b6e43063d174
                    End
                    LayoutCachedLeft =285
                    LayoutCachedTop =120
                    LayoutCachedWidth =1245
                    LayoutCachedHeight =435
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1415
                    Top =113
                    Height =315
                    GUID = Begin
                        0x892929f8250e3e4d97d80f73584eccc4
                    End
                    Name ="ctlCategoryComparer"
                    RowSourceType ="Value List"
                    RowSource ="\"=\";\"Begins with\";\"Contains\";\"<>\";\"Does not contain\";\"Matches\""
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =1415
                    LayoutCachedTop =113
                    LayoutCachedWidth =3116
                    LayoutCachedHeight =428
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3342
                    Top =113
                    Height =315
                    TabIndex =1
                    Name ="ctlCategory"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0x95f013a34eccfe4d827691b87fe643cd
                    End

                    LayoutCachedLeft =3342
                    LayoutCachedTop =113
                    LayoutCachedWidth =5043
                    LayoutCachedHeight =428
                End
                Begin Label
                    OverlapFlags =85
                    Left =285
                    Top =510
                    Width =855
                    Height =315
                    Name ="Bezeichnungsfeld45"
                    Caption ="Module:"
                    GUID = Begin
                        0x31e8b07108bbb241b6957f1c29f9e8ba
                    End
                    LayoutCachedLeft =285
                    LayoutCachedTop =510
                    LayoutCachedWidth =1140
                    LayoutCachedHeight =825
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1415
                    Top =510
                    Height =315
                    TabIndex =2
                    GUID = Begin
                        0xee8efde81469374782034c688fe635e1
                    End
                    Name ="ctlModuleComparer"
                    RowSourceType ="Value List"
                    RowSource ="\"=\";\"Begins with\";\"Contains\";\"<>\";\"Does not contain\";\"Matches\""
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =1415
                    LayoutCachedTop =510
                    LayoutCachedWidth =3116
                    LayoutCachedHeight =825
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3342
                    Top =510
                    Height =315
                    TabIndex =3
                    Name ="ctlModule"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0x9b30a892acbf1b41957e5e5a28813384
                    End

                    LayoutCachedLeft =3342
                    LayoutCachedTop =510
                    LayoutCachedWidth =5043
                    LayoutCachedHeight =825
                End
                Begin Label
                    OverlapFlags =85
                    Left =283
                    Top =907
                    Width =1095
                    Height =315
                    Name ="Bezeichnungsfeld48"
                    Caption ="Procedure:"
                    GUID = Begin
                        0x34e91b61af321143b9467d670d5e1e81
                    End
                    LayoutCachedLeft =283
                    LayoutCachedTop =907
                    LayoutCachedWidth =1378
                    LayoutCachedHeight =1222
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1413
                    Top =907
                    Height =315
                    TabIndex =4
                    GUID = Begin
                        0xd6dc65db6ea77e46a131cbf26fba2532
                    End
                    Name ="ctlProcedureComparer"
                    RowSourceType ="Value List"
                    RowSource ="\"=\";\"Begins with\";\"Contains\";\"<>\";\"Does not contain\";\"Matches\""
                    AfterUpdate ="[Event Procedure]"

                    LayoutCachedLeft =1413
                    LayoutCachedTop =907
                    LayoutCachedWidth =3114
                    LayoutCachedHeight =1222
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =3340
                    Top =907
                    Height =315
                    TabIndex =5
                    Name ="ctlProcedure"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0xed2c2104de8a16429915af492b89b450
                    End

                    LayoutCachedLeft =3340
                    LayoutCachedTop =907
                    LayoutCachedWidth =5041
                    LayoutCachedHeight =1222
                End
                Begin Label
                    OverlapFlags =85
                    Left =285
                    Top =1550
                    Width =900
                    Height =285
                    Name ="Bezeichnungsfeld51"
                    Caption ="Type:"
                    GUID = Begin
                        0x986a9269c74905419c4d278858c2a160
                    End
                    LayoutCachedLeft =285
                    LayoutCachedTop =1550
                    LayoutCachedWidth =1185
                    LayoutCachedHeight =1835
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =1587
                    Top =1637
                    TabIndex =7
                    Name ="ctlEvtStatus"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    GUID = Begin
                        0x93b742ca9e1f4f489716414058429298
                    End

                    LayoutCachedLeft =1587
                    LayoutCachedTop =1637
                    LayoutCachedWidth =1847
                    LayoutCachedHeight =1877
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =1814
                            Top =1535
                            Width =720
                            Height =315
                            Name ="Bezeichnungsfeld53"
                            Caption ="Status"
                            GUID = Begin
                                0x797838057a5b684ab1efbfb559c52e60
                            End
                            LayoutCachedLeft =1814
                            LayoutCachedTop =1535
                            LayoutCachedWidth =2534
                            LayoutCachedHeight =1850
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =2745
                    Top =1637
                    TabIndex =8
                    Name ="ctlEvtCreateDestroy"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    GUID = Begin
                        0xa0cb84ed025d594f99101d96834c1016
                    End

                    LayoutCachedLeft =2745
                    LayoutCachedTop =1637
                    LayoutCachedWidth =3005
                    LayoutCachedHeight =1877
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =3000
                            Top =1530
                            Width =1590
                            Height =315
                            Name ="Bezeichnungsfeld55"
                            Caption ="Create / Destroy"
                            GUID = Begin
                                0x6a4d51c4a14e4b4a98ef4d93f2baad58
                            End
                            LayoutCachedLeft =3000
                            LayoutCachedTop =1530
                            LayoutCachedWidth =4590
                            LayoutCachedHeight =1845
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =93
                    Left =4818
                    Top =1632
                    TabIndex =6
                    Name ="ctlEvtEnterLeave"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    GUID = Begin
                        0xda76a1948024ba419a1905950f68f74d
                    End

                    LayoutCachedLeft =4818
                    LayoutCachedTop =1632
                    LayoutCachedWidth =5078
                    LayoutCachedHeight =1872
                    Begin
                        Begin Label
                            OverlapFlags =255
                            Left =5038
                            Top =1530
                            Width =1290
                            Height =315
                            Name ="Bezeichnungsfeld59"
                            Caption ="Enter / Leave"
                            GUID = Begin
                                0xd08ad02d832fdc49af79e664aa290761
                            End
                            LayoutCachedLeft =5038
                            LayoutCachedTop =1530
                            LayoutCachedWidth =6328
                            LayoutCachedHeight =1845
                        End
                    End
                End
                Begin Rectangle
                    OverlapFlags =247
                    Left =1362
                    Top =1380
                    Width =5226
                    Height =624
                    Name ="Rechteck62"
                    GUID = Begin
                        0x3bbeabfbb6915646a74558cedfa4b65c
                    End
                    LayoutCachedLeft =1362
                    LayoutCachedTop =1380
                    LayoutCachedWidth =6588
                    LayoutCachedHeight =2004
                End
                Begin OptionGroup
                    BackStyle =1
                    OverlapFlags =85
                    Left =7596
                    Top =2270
                    Width =1305
                    Height =495
                    TabIndex =12
                    Name ="ctlActive"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="0"
                    GUID = Begin
                        0xad411884afd60a478ccbc1cf84ce5b90
                    End

                    LayoutCachedLeft =7596
                    LayoutCachedTop =2270
                    LayoutCachedWidth =8901
                    LayoutCachedHeight =2765
                    Begin
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =7653
                            Top =2319
                            Width =585
                            Height =390
                            OptionValue =1
                            Name ="selStart"
                            Caption ="Start"
                            GUID = Begin
                                0x0a11fbdd65f52b43bdcd0d36225b7e41
                            End
                            LayoutCachedLeft =7653
                            LayoutCachedTop =2319
                            LayoutCachedWidth =8238
                            LayoutCachedHeight =2709
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =8276
                            Top =2319
                            Width =570
                            Height =390
                            OptionValue =0
                            Name ="selStop"
                            Caption ="Stop"
                            GUID = Begin
                                0xd3869e38b463884f9b5ec2d5544b1861
                            End
                            LayoutCachedLeft =8276
                            LayoutCachedTop =2319
                            LayoutCachedWidth =8846
                            LayoutCachedHeight =2709
                        End
                    End
                End
            End
        End
        Begin Section
            Height =4138
            Name ="Detailbereich"
            GUID = Begin
                0xc87c6ea896b7854190a08ddbe1e52989
            End
            Begin
                Begin OptionGroup
                    BackStyle =1
                    OverlapFlags =85
                    Left =6122
                    Top =3741
                    Width =2766
                    Height =397
                    Name ="selTrace"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    GUID = Begin
                        0xe0d54066ade0c24eb5452d0654b84066
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =6122
                    LayoutCachedTop =3741
                    LayoutCachedWidth =8888
                    LayoutCachedHeight =4138
                    Begin
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =6179
                            Top =3798
                            Width =553
                            OptionValue =1
                            Name ="Umschaltfläche35"
                            Caption ="Run"
                            GUID = Begin
                                0x0f73996bed3c5043912cef285707a72d
                            End
                            VerticalAnchor =1
                            LayoutCachedLeft =6179
                            LayoutCachedTop =3798
                            LayoutCachedWidth =6732
                            LayoutCachedHeight =4081
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =6732
                            Top =3798
                            Width =688
                            OptionValue =2
                            Name ="Umschaltfläche36"
                            Caption ="Pause"
                            GUID = Begin
                                0xac9936a5d5b357439f3fa9bd2cd0c708
                            End
                            VerticalAnchor =1
                            LayoutCachedLeft =6732
                            LayoutCachedTop =3798
                            LayoutCachedWidth =7420
                            LayoutCachedHeight =4081
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =7420
                            Top =3798
                            Width =688
                            OptionValue =3
                            Name ="Umschaltfläche37"
                            Caption ="Step"
                            GUID = Begin
                                0x23ff13a17115734593860b2005556235
                            End
                            VerticalAnchor =1
                            LayoutCachedLeft =7420
                            LayoutCachedTop =3798
                            LayoutCachedWidth =8108
                            LayoutCachedHeight =4081
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =8108
                            Top =3798
                            Width =748
                            OptionValue =4
                            Name ="Umschaltfläche38"
                            Caption ="Break"
                            GUID = Begin
                                0x27cc5e497d39b149b0f274e8deea0540
                            End
                            VerticalAnchor =1
                            LayoutCachedLeft =8108
                            LayoutCachedTop =3798
                            LayoutCachedWidth =8856
                            LayoutCachedHeight =4081
                        End
                    End
                End
                Begin TextBox
                    OldBorderStyle =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =1077
                    Top =3798
                    Height =315
                    TabIndex =1
                    Name ="ctlCounter"
                    GUID = Begin
                        0xe0699e7046444344b4ebe6c27eddcc10
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =1077
                    LayoutCachedTop =3798
                    LayoutCachedWidth =2778
                    LayoutCachedHeight =4113
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =226
                            Top =3798
                            Width =750
                            Height =315
                            Name ="Bezeichnungsfeld40"
                            Caption ="Count:"
                            GUID = Begin
                                0xb9d46c155b80794c8eda8b049045e0d2
                            End
                            VerticalAnchor =1
                            LayoutCachedLeft =226
                            LayoutCachedTop =3798
                            LayoutCachedWidth =976
                            LayoutCachedHeight =4113
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3401
                    Top =3798
                    TabIndex =2
                    Name ="cmdClear"
                    Caption ="Clear"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x598985b72aa2e940a415aca40a308825
                    End
                    VerticalAnchor =1

                    LayoutCachedLeft =3401
                    LayoutCachedTop =3798
                    LayoutCachedWidth =5102
                    LayoutCachedHeight =4081
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Width =9360
                    Height =3690
                    AutoActivate =1
                    TabIndex =3
                    Name ="ctliGrid"
                    OleData = Begin
                        0x000e0000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000020000000000000000100000 ,
                        0x0400000001000000feffffff0000000003000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffdfffffffeffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000feffffff00000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000052006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff010000001c6ca26c0aaf5b42a7e37e6f ,
                        0xfad8b5eb00000000000000000000000040577f2336d5cc0105000000c0000000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000100000058000000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000038000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffefffffffeffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xfffffffffeffffff02000000feffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff38000000000000000100000000000000000000000000000000000000 ,
                        0x0000000038000000000000000000000000000000000000000000000013019400 ,
                        0x000100001c6ca26c0aaf5b42a7e37e6ffad8b5eb93b200004800000003000800 ,
                        0x0bf25747200000005f0065007800740065006e00740078007e40000003000800 ,
                        0x0af25747e0ffffff5f0065007800740065006e00740079006d1900000c111a1d ,
                        0x900e00002800056000000000ffffffffffffffff0000000000000000ffffffff ,
                        0x00000000ffffffffffffffff840c28000e000e0000009400000100006084fa1c ,
                        0xffffffffffffffff0300ffff00000000650000000c112c1de80e000029000560 ,
                        0x00000000ffffffffffffffff0000000000000000ffffffff00000000ffffffff ,
                        0xffffffff880c29000e000e0000009400000100006084fa1cffffffffffffffff ,
                        0x0300ffff00000000000000000c11821b280f00002a00056000000000ffffffff ,
                        0xffffffff0000000000000000ffffffff00000000ffffffffffffffff8c0c2a00 ,
                        0x0b000b0000009400000100000c119a1b680f00002b00056000000000ffffffff ,
                        0xffffffff0000000000000000ffffffff00000000ffffffffffffffff900c2b00 ,
                        0x0500050000009400000100000c119c1ba80f00002c00056000000000ffffffff ,
                        0xffffffff0000000000000000ffffffff00000000ffffffffffffffff940c2c00 ,
                        0x0300030000000000
                    End
                    OLEClass ="10Tec iGrid Control 4.7"
                    Class ="iGrid470_10Tec.iGrid"
                    GUID = Begin
                        0x5149c3a25f17934ab831ca52af7471e9
                    End
                    HorizontalAnchor =2
                    VerticalAnchor =2

                    LayoutCachedWidth =9360
                    LayoutCachedHeight =3690
                End
            End
        End
        Begin FormFooter
            Height =0
            Name ="Formularfuß"
            GUID = Begin
                0xb85d5c3861f7af488cfa8d75d4016748
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'---------------------------------------------------------------------------------------
' Module    : Form_frmLog_Logger
' Author    : K.Gundermann
' Date      : 17.01.2012
' Purpose   : Displays only Trace Events in a iGrid
'---------------------------------------------------------------------------------------

Option Compare Database
Option Explicit

Implements ILogSaver

Private WithEvents c_Logger   As clsLogger
Attribute c_Logger.VB_VarHelpID = -1
Private WithEvents c_Session  As clsLogSession
Attribute c_Session.VB_VarHelpID = -1
Private c_Filters             As clsLogFilterCollection

Private c_Name                As String

Private Enum e_TraceStatus
  Trc_Run = 1
  Trc_Pause
  Trc_Step
  Trc_Break
End Enum

Private Sub Class_Initialize()
  Set c_Session = Logger.Log.Session
  Set c_Filters = New clsLogFilterCollection
End Sub
Private Sub Class_Terminate()
  Call StopLog
  Set c_Session = Nothing
  Set c_Filters = Nothing
End Sub


' --- Public Interface ---
Public Sub StartLog()
  Set c_Logger = Logger.Log
  Me.ctlActive = 1
End Sub

Public Sub StopLog()
  Set c_Logger = Nothing
  Me.ctlActive = 0
End Sub

Public Sub SaveToLog(ByRef objLogEntry As clsLogEntry)
  If Filters.MatchFilter(objLogEntry) Then
    Call SaveToMyLog(objLogEntry)
  End If
End Sub

Public Function AddFilter(ByVal TheFilter As clsLogFilter) As ILogSaver
  If Filters.Count > 0 Then Filters.Clear  ' Only ONE Filter here !
  Filters.AddFilter TheFilter
  Me.TimerInterval = 30 ' Call DisplayFilter
  Set AddFilter = Me
End Function

Public Property Get ID() As Long
  ID = ObjPtr(Me)
End Property
'Public Property Get Name() As String
'  If c_Name = vbNullString Then
'    Name = TypeName(Me)
'  Else
'    Name = c_Name
'  End If
'End Property
'Public Property Let Name(ByVal TheName As String)
'  c_Name = TheName
'End Property


' --- Private Functions ---
Private Property Get Filters() As clsLogFilterCollection
  Set Filters = c_Filters
End Property

' --- Event Handler for Logger/Session Class ---
Private Sub c_Logger_SaveToLog(objLogEntry As clsLogEntry)
  Call SaveToLog(objLogEntry)
End Sub

Private Sub c_Session_Login()
  ' ToDo: We have now a logged In User
End Sub

Private Sub c_Session_Logout()
  ' ToDo: The user has logged out
End Sub


' --- Implements ILogSaver ---
Private Sub ILogSaver_StartLog()
  Me.StartLog
End Sub
Private Sub ILogSaver_StopLog()
  Me.StopLog
End Sub
Private Function ILogSaver_AddFilter(ByVal TheFilter As clsLogFilter) As ILogSaver
  Set ILogSaver_AddFilter = Me.AddFilter(TheFilter)
End Function
Private Property Get ILogSaver_ID() As Long
  ILogSaver_ID = Me.ID
End Property
Private Property Get ILogSaver_Name() As String
  ILogSaver_Name = Me.Name
End Property
Private Property Let ILogSaver_Name(ByVal TheName As String)
  Me.Name = TheName
End Property
Private Sub ILogSaver_SaveToLog(objLogEntry As clsLogEntry)
  Call Me.SaveToLog(objLogEntry)
End Sub

' #################################################################################

' ---------------------------------------------------------------------------------
' -- Specific Functions for that logger here

Public Sub SaveToMyLog(ByRef objLogEntry As clsLogEntry)
  Static lStackLevel As Long
  
  With objLogEntry
    If .Severity = Sev_Trace Then
      Select Case .EntryType
        Case Evt_Entering: lStackLevel = lStackLevel + 1
        Case Evt_Leaving: lStackLevel = lStackLevel - 1
      End Select
      
      Call Grid_Add(.Timestamp, lStackLevel, .Category, .FromModule, .FromProcedure, .TraceEventText, .MessageText)
    End If
  End With
  
  Me.ctlCounter = Nz(Me.ctlCounter) + 1
    
  Call WaitOrContinue
  
End Sub

Private Sub Form_Open(Cancel As Integer)
  Call Class_Initialize
End Sub

Private Sub Form_Load()
  Me.Visible = True
  Call Grid_Setup
  
  Call SetSeverityFilter

  Call ctlActive_AfterUpdate
  Call selTrace_AfterUpdate
End Sub
Private Sub Form_Unload(Cancel As Integer)
  Call StopLog
End Sub
Private Sub Form_Close()
  Call Class_Terminate
End Sub

Private Sub Form_Timer()
  Me.TimerInterval = 0
  Call DisplayFilter
End Sub
Private Sub Form_Resize()
  Call Grid_Resize
End Sub

Private Function MyFilter() As clsLogFilter
  If Filters.Count = 0 Then
    Me.AddFilter New clsLogFilter
  End If
  Set MyFilter = Filters.Collection(1)
End Function

Private Sub DisplayFilter()
  Call DisplayCategoryFilter
  Call DisplayModuleFilter
  Call DisplayProcedureFilter
  Call DisplayEntryTypeFilter
  Call DisplaySeverityFilter
  Call DisplayNumberFilter
  Call DisplayTextFilter
End Sub

' ########################################################################################

Private Sub DisplayCategoryFilter()
  If MyFilter.CategoryMatcher Is Nothing Then
    Me.ctlCategoryComparer.Value = ""
    Me.ctlCategory.Value = ""
  Else
    Me.ctlCategoryComparer.Value = MyFilter.CategoryMatcher.MatchToString
    Me.ctlCategory.Value = MyFilter.CategoryMatcher.ValueToString
  End If
End Sub
Private Sub SetCategoryFilter()
  If Nz(Me.ctlCategory) <> vbNullString Then
    MyFilter.WithCategory2 Nz(Me.ctlCategoryComparer), Nz(Me.ctlCategory)
  Else
    Set MyFilter.CategoryMatcher = Nothing
  End If
End Sub
Private Sub ctlCategoryComparer_AfterUpdate()
  If IsNullString(Nz(Me.ctlCategoryComparer)) Then Me.ctlCategory = vbNullString
  SetCategoryFilter
End Sub
Private Sub ctlCategory_AfterUpdate()
  If IsNullString(Nz(Me.ctlCategory)) Then
    Me.ctlCategoryComparer = vbNullString
  ElseIf IsNullString(Nz(Me.ctlCategoryComparer)) Then
    Me.ctlCategoryComparer = "="
  End If
  SetCategoryFilter
End Sub

' ---------------------------------------------------------------------------------------
Private Sub DisplayModuleFilter()
  If MyFilter.ModuleMatcher Is Nothing Then
    Me.ctlModuleComparer.Value = ""
    Me.ctlModule.Value = ""
  Else
    Me.ctlModuleComparer.Value = MyFilter.ModuleMatcher.MatchToString
    Me.ctlModule.Value = MyFilter.ModuleMatcher.ValueToString
  End If
End Sub
Private Sub SetModuleFilter()
  If Nz(Me.ctlModule) <> vbNullString Then
    MyFilter.WithModule2 Nz(Me.ctlModuleComparer), Nz(Me.ctlModule)
  Else
    Set MyFilter.ModuleMatcher = Nothing
  End If
End Sub
Private Sub ctlModuleComparer_AfterUpdate()
  If IsNullString(Nz(Me.ctlModuleComparer)) Then Me.ctlModule = vbNullString
  SetModuleFilter
End Sub
Private Sub ctlModule_AfterUpdate()
  If IsNullString(Nz(Me.ctlModule)) Then
    Me.ctlModuleComparer = vbNullString
  ElseIf IsNullString(Nz(Me.ctlModuleComparer)) Then
    Me.ctlModuleComparer = "="
  End If
  SetModuleFilter
End Sub

' ---------------------------------------------------------------------------------------

Private Sub DisplayProcedureFilter()
  If MyFilter.ProcedureMatcher Is Nothing Then
    Me.ctlProcedureComparer.Value = ""
    Me.ctlProcedure.Value = ""
  Else
    Me.ctlProcedureComparer.Value = MyFilter.ProcedureMatcher.MatchToString
    Me.ctlProcedure.Value = MyFilter.ProcedureMatcher.ValueToString
  End If
End Sub
Private Sub SetProcedureFilter()
  If Nz(Me.ctlProcedure) <> vbNullString Then
    MyFilter.WithProcedure2 Nz(Me.ctlProcedureComparer), Nz(Me.ctlProcedure)
  Else
    Set MyFilter.ProcedureMatcher = Nothing
  End If
End Sub
Private Sub ctlProcedureComparer_AfterUpdate()
  If IsNullString(Nz(Me.ctlProcedureComparer)) Then Me.ctlProcedure = vbNullString
  SetProcedureFilter
End Sub
Private Sub ctlProcedure_AfterUpdate()
  If IsNullString(Nz(Me.ctlProcedure)) Then
    Me.ctlProcedureComparer = vbNullString
  ElseIf IsNullString(Nz(Me.ctlProcedureComparer)) Then
    Me.ctlProcedureComparer = "="
  End If
  SetProcedureFilter
End Sub

' ---------------------------------------------------------------------------------------

Private Sub DisplayEntryTypeFilter()
  Dim lngBitmap As Long
  
  If Not (MyFilter.EntryTypeMatcher Is Nothing) Then
    lngBitmap = MyFilter.EntryTypeMatcher.Value
  End If
  
  Me.ctlEvtStatus = (lngBitmap And Evt_Status)
  Me.ctlEvtCreateDestroy = (lngBitmap And Evt_Creating)
  ' Me.ctlEvtDestroy = (lngBitmap And Evt_Destroying)
  Me.ctlEvtEnterLeave = (lngBitmap And Evt_Entering)
  ' Me.ctlEvtLeave = (lngBitmap And Evt_Leaving)

End Sub
Private Sub SetEntryTypeFilter()
  Dim lngBitmap As Long
  
  If Nz(Me.ctlEvtStatus) Then lngBitmap = lngBitmap + Evt_Status
  If Nz(Me.ctlEvtCreateDestroy) Then lngBitmap = lngBitmap + Evt_Creating + Evt_Destroying
  If Nz(Me.ctlEvtEnterLeave) Then lngBitmap = lngBitmap + Evt_Entering + Evt_Leaving
  
  MyFilter.WithType lngBitmap
End Sub
Private Sub ctlEvtStatus_AfterUpdate()
  Call SetEntryTypeFilter
End Sub
Private Sub ctlEvtCreateDestroy_AfterUpdate()
  SetEntryTypeFilter
End Sub
Private Sub ctlEvtEnterLeave_AfterUpdate()
  SetEntryTypeFilter
End Sub

' ---------------------------------------------------------------------------------------

Private Sub DisplaySeverityFilter()
  ' Do Nothing
End Sub
Private Sub SetSeverityFilter()
  MyFilter.WithSeverity Sev_Trace
End Sub

' ---------------------------------------------------------------------------------------

Private Sub DisplayNumberFilter()
  If MyFilter.MessageNumberMatcher Is Nothing Then
    Me.ctlNumberComparer.Value = ""
    Me.ctlNumber1.Value = ""
    Me.ctlNumber2.Value = ""
  Else
    Me.ctlNumberComparer.Value = MyFilter.MessageNumberMatcher.MatchToString
    Me.ctlNumber1.Value = MyFilter.MessageNumberMatcher.Value1
    Me.ctlNumber2.Value = MyFilter.MessageNumberMatcher.Value2
  End If
End Sub
Private Sub SetNumberFilter()
  If Nz(Me.ctlNumber1) <> 0 Then
    MyFilter.WithMessageNumber Nz(Me.ctlNumberComparer), Nz(Me.ctlNumber1), Nz(Me.ctlNumber2)
  End If
End Sub
Private Sub ctlNumberComparer_AfterUpdate()
  SetNumberFilter
End Sub
Private Sub ctlNumber1_AfterUpdate()
  SetNumberFilter
End Sub
Private Sub ctlNumber2_AfterUpdate()
  SetNumberFilter
End Sub

' ---------------------------------------------------------------------------------------

Private Sub DisplayTextFilter()
  If MyFilter.MessageTextMatcher Is Nothing Then
    Me.ctlTextComparer = ""
    Me.ctlText = ""
  Else
    Me.ctlTextComparer = MyFilter.MessageTextMatcher.MatchToString
    Me.ctlText = MyFilter.MessageTextMatcher.ValueToString
  End If
End Sub
Private Sub SetTextFilter()
  If Nz(Me.ctlText) <> vbNullString Then
    MyFilter.WithMessageText2 Nz(Me.ctlTextComparer), Nz(Me.ctlText)
  End If
End Sub
Private Sub ctlTextComparer_AfterUpdate()
  SetTextFilter
End Sub
Private Sub ctlText_AfterUpdate()
  SetTextFilter
End Sub


' ########################################################################################


Private Sub ctlActive_AfterUpdate()
  Select Case Nz(Me.ctlActive)
    Case 0: Me.StopLog
            Me.ctlActive.BackColor = vbRed
    Case 1: Me.StartLog
            Me.ctlActive.BackColor = vbGreen
  End Select
End Sub

Private Sub cmdClear_Click()
  Call Grid_Clear
  Me.ctlCounter = 0
End Sub

Private Sub WaitOrContinue()
  DoEvents
  Do
    Select Case Nz(Me.selTrace)
      Case 0, Trc_Run:
            Exit Sub  ' Continue ..
      Case Trc_Pause:
            DoEvents  ' Wait for Run/Step
      Case Trc_Step:
            Me.selTrace = Trc_Pause:
            Exit Sub   ' Run and pause at next Message
      Case Trc_Break:
            Me.selTrace = Trc_Pause
            Stop       ' Break into debugger
            Exit Sub
    End Select
  Loop
  
End Sub

Private Sub selTrace_AfterUpdate()
    Select Case Nz(Me.selTrace)
      Case 0, Trc_Run:
            If Me.selTrace.BackColor <> vbGreen Then Me.selTrace.BackColor = vbGreen
      Case Trc_Pause:
            If Me.selTrace.BackColor <> vbYellow Then Me.selTrace.BackColor = vbYellow
      Case Trc_Step:
      Case Trc_Break:
    End Select
End Sub

' ########################################################################################

Private Property Get Grid() As Object ' iGrid470_10Tec.iGrid
  Set Grid = Me.ctliGrid.Object
End Property

Private Sub Grid_Setup()
  With Grid
    .Clear True
    .AddCol "1", "Time", lMinWidth:=90
    .AddCol "2", "StackLevel"
    .AddCol "3", "Category"
    .AddCol "4", "Module", lMinWidth:=100
    .AddCol "5", "Procedure", lMinWidth:=90
    .AddCol "6", "Number"
    .AddCol "7", "Text"
  End With
  Call Grid_Resize
End Sub

Private Sub Grid_Resize()
  Grid.ResizeColToFillSpace (7)
End Sub

Private Sub Grid_Clear()
  Grid.Clear
End Sub

Private Sub Grid_Add(Timestamp As clsDateTime, StackLevel As Long, Category As String, FromModule As String, FromProcedure As String, MessageNumber As String, MessageText As String)
  Dim lRow As Long
  
  With Grid
    '.BeginUpdate
    lRow = .AddRow
    .CellValue(lRow, 1) = Timestamp.ToString(dt_Time)
    .CellValue(lRow, 2) = StackLevel
    .CellValue(lRow, 3) = Category
    .CellValue(lRow, 4) = FromModule
    .CellValue(lRow, 5) = FromProcedure
    .CellValue(lRow, 6) = MessageNumber
    .CellValue(lRow, 7) = MessageText
    Call .SetCurCell(lRow, 1)
    '.EndUpdate
  End With
End Sub
